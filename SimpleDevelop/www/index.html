<!DOCTYPE html>

<html>
  <head>
    <title>SimpleDevelop</title>
    <link rel="stylesheet" type="text/css" href="/codemirror.css" />
    <link rel="stylesheet" type="text/css" href="/theme/solarized.css" />
    <script type="text/javascript" src="/codemirror-3.1.js"></script>
    <script type="text/javascript" src="/mode/clike.js"></script>
    <script type="text/javascript" src="/jquery-1.9.1.min.js"></script>

    <style type="text/css">
      html, body {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
      }

      .CodeMirror {
        position: absolute;
        top: 0;
        bottom: 0;
        height: 100%;
        width: 100%;

        font-family: "Source Code Pro", Consolas, Inconsolata, monospace;
        font-size: 16px;
      }

      .CodeMirror-scroll {
        overflow: auto;
      }

      .editing .CodeMirror {
        left: 0;
        right: 0;
      }

      .results {
        position: absolute;
        display: none;
        top: 0;
        bottom: 0;
        right: 0;
        width: 0;

        background-color: #000;
        color: #fff;
        font-family: "Source Code Pro", Consolas, Inconsolata, monospace;
        font-size: 14px;
        overflow: auto;
      }

      .viewing-results .CodeMirror {
        left: 0;
        right: 50%;
      }

      .viewing-results .results {
        display: block;
        left: 50%;
        width: auto;
        padding: 25px;
      }

      .toolbar {
        position: absolute;
        bottom: 20px;
        left: 20px;
        right: 20px;
        height: 60px;
        opacity: 0.5;
        filter: alpha(opacity = 50);
        z-index: 10;
      }

      .editing .toolbar {
        background: #000;
      }

      .viewing-results .toolbar {
        background-color: #444;
      }

      .toolbar a {
        display: inline-block;
        float: right;
        line-height: 60px;
        color: #fff;
        font-family: "Open Sans", Helvetica, Arial, sans-serif;
        font-size: 16px;
        padding: 0 1em;
        text-decoration: none;
      }

      .toolbar a:hover {
        background-color: #fff;
        color: #888;
      }
    </style>

    <script type="text/javascript">
      $(document).ready(function() {
        var $body    = $("body"),
            $results = $(".results"),
            editor   = CodeMirror.fromTextArea(document.getElementById("editor"), {
              lineNumbers: true,
              mode: "text/x-csharp",
              theme: "solarized dark"
            });

        $(".exit").click(function() {
          $.ajax({ url: "/exit", type: "POST", complete: function() {
            window.close();
          }});
        });

        $(".compile").click(function() {
          $.ajax({ url: "/compile", type: "POST", data: { code: editor.getValue() },
            success: function(results) {
              $body.attr("class", "viewing-results");
              $results.html("<pre>" + results + "</pre>");
            }
          })
        });

        $results.click(function() {
          $body.attr("class", "editing");
          $results.empty();
        });

        // CodeMirror.on(window, "resize", function() {
        //   var $window      = $(window),
        //       $wrapper     = $(editor.getWrapperElement()),
        //       windowHeight = $window.height(),
        //       windowWidth  = $window.width();
        //   $wrapper.height(windowHeight);
        //   $wrapper.width(windowWidth);
        // });
      });
    </script>
  </head>

  <body class="editing">
    <!-- TODO: see if there's a way to make this less hideous (yes it bothers me). -->
    <textarea id="editor">using System;

class Program
{
  public static void Main(string[] args)
  {
    Console.WriteLine("Hello, world!");
  }
}</textarea>
    <div class="results empty"></div>
    <div class="toolbar">
      <a class="exit" href="#">Exit</a>
      <a class="compile" href="#">Compile</a>
    </div>
  </body>

</html>
